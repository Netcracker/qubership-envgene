---
# This workflow executes several linters on changed files based on languages used in your code base whenever
# you push a code or open a pull request.
#
# You can adjust the behavior by modifying this file.
# For more information, see:
# https://github.com/super-linter/super-linter
# Configuration file for super-linter example:
# .github/super-linter.env
# Configuration files for individual linters should be placed in .github/linters

name: "Lint Code Base"

on:
  pull_request:
    types:
      - opened
      - edited
      - synchronize
  workflow_dispatch:
    inputs:
      full_scan:
        type: boolean
        default: true
        required: false
        description: "Lint all codebase"

permissions:
  contents: read
  statuses: write

jobs:
  run-lint:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          # Full git history is needed to get a proper list of changed files within `super-linter`
          fetch-depth: 0
          persist-credentials: false

      - name: Ensure local main exists for diff base
        shell: bash
        run: |
          git remote -v
          git fetch origin +refs/heads/*:refs/remotes/origin/*
          git show-ref --verify --quiet refs/heads/main || git branch main origin/main || true

      - name: Lint Code Base
        uses: ./.github/actions/super-linter
        with:
          full_scan: ${{ github.event_name == 'workflow_dispatch' && inputs.full_scan || false }}
          github-token: ${{ secrets.GITHUB_TOKEN }}
